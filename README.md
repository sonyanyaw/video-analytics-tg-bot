# Описание проекта

## Как запустить проект локально

### С использованием Docker
1. Убедитесь, что у вас установлен Docker и Docker Compose.
2. Склонируйте репозиторий проекта:
   ```bash
   git clone https://github.com/sonyanyaw/video-analytics-tg-bot
   cd tg_bot_video_analytics
   ```
3. Соберите и запустите контейнеры с помощью Docker Compose:
   ```bash
   docker-compose up --build -d
   ```
4. Проект будет доступен локально. Убедитесь, что все сервисы запущены корректно.

### Без использования Docker
1. Убедитесь, что у вас установлен Python версии 3.9 или выше.
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Настройте базу данных PostgreSQL:
   - Запустите инициализацию базы данных и загрузку данных с помощью следующих команд:
   ```bash
   python src/database/init_db.py
   python src/database/load_json.py
   ```
4. Запустите проект:
   ```bash
   python src/main.py
   ```

## Как задать токен Telegram-бота
1. Создайте файл `.env` в корне проекта (если он ещё не создан).
2. Добавьте в файл строку с токеном вашего Telegram-бота:
   ```env
   TELEGRAM_BOT_TOKEN=<ВАШ_ТОКЕН>
   ```
3. Убедитесь, что файл `.env` загружается при запуске проекта. Это уже настроено в проекте.

## Краткое описание архитектуры

### Архитектура проекта
Проект состоит из следующих основных модулей:
- **`src/bot/`**: Логика Telegram-бота, включая обработку сообщений и маршрутизацию.
- **`src/nlp/`**: Модуль обработки естественного языка (NLQ), преобразующий текстовые запросы в SQL.
- **`src/database/`**: Работа с базой данных, включая выполнение SQL-запросов и управление соединениями.

### Подход к преобразованию текстовых запросов в SQL
1. Пользователь отправляет текстовый запрос в Telegram-бот.
2. Модуль `src/nlp/nlq.py` использует API Yandex GPT для преобразования текста в SQL-запрос. Это достигается с помощью заранее подготовленного промпта, который задаёт правила генерации SQL.
3. Сгенерированный SQL-запрос передаётся в модуль `src/database/sql_exec.py`, который выполняет запрос к базе данных PostgreSQL.
4. Результат выполнения SQL-запроса возвращается пользователю через Telegram-бота.